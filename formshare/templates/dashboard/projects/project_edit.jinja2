{% extends 'dashboard/page.jinja2' %}
{% import 'dashboard/macros/form.jinja2' as form %}

{% block titlesection %}{{ _("Edit project") }}{% endblock titlesection %}

{% block css %}
    {{ super() }}
    {% cssresource request,'formshare','bsmarkdown' %}
    {% cssresource request,'formshare','switchery' %}
{% endblock css %}

{% block topScripts %}
    {{ super() }}
    {% jsresource request,'formshare','markdown' %}
    {% jsresource request,'formshare','switchery' %}
{% endblock topScripts %}

{% block breadcrumbs %}
    {% include 'dashboard/projects/snippets/brdcrbs_prjedit.jinja2' %}
{% endblock breadcrumbs %}

{% block maincontent %}
    <div class="ibox">
        <div class="ibox-title">
            <h5>{{ projectDetails.project_name }}</h5>
            <div class="ibox-tools">
                <a class="fullscreen-link">
                    <i class="fa fa-expand"></i>
                </a>
            </div>
        </div>
        <div class="ibox-content">
            {% block form_errors %}
                {{ form.display_errors(errors) }}
            {% endblock form_errors %}
            {% include 'dashboard/projects/snippets/project_form_edit.jinja2' %}
        </div>
    </div>
{% endblock maincontent %}

{% block scripts %}
    {{ super() }}
    <script>
        $(document).ready(function() {
            var elem = document.querySelector('.js-switch');
            var switchery = new Switchery(elem, { color: '#1AB394' });

            $( "#uploadbutton" ).click(function() {
                $( "#filetoupload" ).click();
            });

            jQuery("#filetoupload").change(function () {
                console.log("Setting file");
                var fileInput = document.getElementById('filetoupload');
                var filename = fileInput.files[0].name;
                var file_object = $("#file_name");
                file_object.val(filename);
                file_object.show();
                file_object.prop('readonly', true);
                $("#clear_section").show();
                $("#uploadbutton").hide();
                $("#linkbutton").hide();
            });

            $( "#clear_button" ).click(function() {
                document.getElementById("filetoupload").value = "";
                var file_object = $("#file_name");
                file_object.val("");
                file_object.hide();
                $("#clear_section").hide();
                $("#uploadbutton").show();
                $("#linkbutton").show();

            });

            $( "#linkbutton" ).click(function() {
                var file_object = $("#file_name");
                file_object.attr("placeholder", "http://example.com/images/test.jpg").blur();
                file_object.show();
                file_object.prop('readonly', false);
                $("#clear_section").show();
                $("#uploadbutton").hide();
                $("#linkbutton").hide();
            });

        });
    </script>

{% endblock scripts %}